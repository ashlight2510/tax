<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>ì„¸ê¸ˆ ê³„ì‚°ê¸° | funnyfunny.cloud</title>
    <meta
      name="description"
      content="ì§ì¥ì¸/í”„ë¦¬ëœì„œ/ê°œì¸ì‚¬ì—…ì ì„¸ê¸ˆÂ·ë³´í—˜Â·ê²½ë¹„ë¥¼ ê°„í¸í•˜ê²Œ ì¶”ì •í•˜ê³ , ì›” ì‹¤ìˆ˜ë ¹ì•¡ê³¼ ì„¸ê¸ˆ ë‚©ë¶€ ì‹œê¸°ë¥¼ í™•ì¸í•˜ì„¸ìš”."
    />

    <!-- OG (ì˜ì–´ + ë„ì–´ì“°ê¸° '+' ê·œì¹™) -->
    <meta property="og:title" content="TAX+CLICK+CALCULATOR" />
    <meta
      property="og:description"
      content="Know+your+real+take-home+in+one+click"
    />
    <meta
      property="og:image"
      content="https://dummyimage.com/1200x630/0b1220/ffffff&text=TAX+CLICK+CALCULATOR"
    />

    <!-- Favicon (SVG data URI: ë‹¨ì¼íŒŒì¼) -->
    <link
      rel="icon"
      type="image/svg+xml"
      href='data:image/svg+xml;utf8,
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
      <rect width="64" height="64" rx="14" fill="%230b1220"/>
      <path d="M18 22h28v6H18zM18 32h20v6H18zM18 42h28v6H18z" fill="%23ffffff" opacity="0.9"/>
      <circle cx="46" cy="35" r="6" fill="%23ff6b6b"/>
    </svg>'
    />
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1204894220949193" crossorigin="anonymous"></script>
    
    <style>
      :root {
        --bg: #f8f9fa;
        --card: #ffffff;
        --text: #1a1a1a;
        --muted: #6b7280;
        --primary: #0b1220;
        --accent: #3b82f6;
        --accent-hover: #2563eb;
        --line: #e5e7eb;
        --ok: #10b981;
        --warning: #f59e0b;
        --shadow: rgba(0, 0, 0, 0.05);
        --shadow-hover: rgba(0, 0, 0, 0.1);
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo",
          "Noto Sans KR", Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        background: var(--bg);
        color: var(--text);
      }
      a {
        color: inherit;
        text-decoration: none;
      }
      .wrap {
        max-width: 860px;
        margin: 0 auto;
        padding: 18px 14px 96px;
      }
      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        margin-bottom: 14px;
      }
      .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 800;
        letter-spacing: 0.2px;
      }
      .brand-badge {
        width: 34px;
        height: 34px;
        border-radius: 10px;
        background: var(--primary);
        display: grid;
        place-items: center;
        color: white;
        font-weight: 900;
      }
      .top-actions {
        display: flex;
        gap: 10px;
        align-items: center;
      }
      .btn {
        border: 1px solid var(--line);
        background: var(--card);
        padding: 12px 16px;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 600;
        font-size: 14px;
        transition: all 0.2s ease;
        box-shadow: 0 1px 2px var(--shadow);
      }
      .btn:hover {
        box-shadow: 0 2px 4px var(--shadow-hover);
        transform: translateY(-1px);
      }
      .btn.primary {
        border-color: transparent;
        background: var(--accent);
        color: white;
        font-weight: 700;
      }
      .btn.primary:hover {
        background: var(--accent-hover);
        box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
      }
      .btn.ghost {
        background: transparent;
        border-color: transparent;
      }
      .btn.ghost:hover {
        background: rgba(0, 0, 0, 0.04);
      }
      .btn:active {
        transform: translateY(0);
      }
      .intro {
        background: linear-gradient(
          180deg,
          #ffffff 0%,
          #ffffff 60%,
          rgba(255, 255, 255, 0) 100%
        );
        border: 1px solid var(--line);
        border-radius: 18px;
        padding: 18px;
        margin-bottom: 14px;
      }
      h1 {
        margin: 0 0 12px;
        font-size: 24px;
        line-height: 1.3;
        font-weight: 800;
        color: var(--text);
      }
      .sub {
        margin: 0;
        color: var(--muted);
        font-size: 15px;
        line-height: 1.6;
      }
      .mode-row {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
        margin-top: 14px;
      }
      @media (min-width: 720px) {
        .mode-row {
          grid-template-columns: repeat(3, 1fr);
        }
      }
      .mode {
        border: 2px solid var(--line);
        background: var(--card);
        border-radius: 16px;
        padding: 18px;
        cursor: pointer;
        text-align: left;
        transition: all 0.2s ease;
        min-height: 100px;
        box-shadow: 0 1px 3px var(--shadow);
      }
      .mode:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--shadow-hover);
        border-color: var(--accent);
      }
      .mode.active {
        border-color: var(--accent);
        background: linear-gradient(
          135deg,
          rgba(59, 130, 246, 0.05) 0%,
          rgba(59, 130, 246, 0.02) 100%
        );
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
      }
      .mode .t {
        font-weight: 800;
        margin: 0 0 6px;
      }
      .mode .d {
        margin: 0;
        color: var(--muted);
        font-size: 13px;
        line-height: 1.35;
      }
      .grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 14px;
      }
      @media (min-width: 900px) {
        .grid {
          grid-template-columns: 1.2fr 0.8fr;
        }
      }
      .panel {
        border: 1px solid var(--line);
        background: var(--card);
        border-radius: 18px;
        padding: 20px;
        box-shadow: 0 1px 3px var(--shadow);
      }
      .panel h2 {
        margin: 0 0 16px;
        font-size: 18px;
        font-weight: 800;
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--text);
      }
      .hint {
        color: var(--muted);
        font-size: 13px;
        line-height: 1.5;
        margin: 0 0 10px;
      }
      .fields {
        display: grid;
        gap: 10px;
      }
      .field {
        display: grid;
        gap: 6px;
      }
      .label {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        color: #374151;
        font-weight: 700;
        margin-bottom: 4px;
      }
      input[type="text"],
      input[type="number"],
      select {
        width: 100%;
        padding: 12px 14px;
        border-radius: 12px;
        border: 1.5px solid var(--line);
        background: #fff;
        font-size: 14px;
        outline: none;
        transition: all 0.2s ease;
      }
      input:focus,
      select:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      .row2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      .seg {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .seg button {
        border: 1px solid var(--line);
        background: #fff;
        padding: 10px 10px;
        border-radius: 999px;
        cursor: pointer;
        font-weight: 750;
        font-size: 13px;
        color: #111;
      }
      .seg button.active {
        background: rgba(11, 18, 32, 0.06);
        border-color: rgba(11, 18, 32, 0.35);
      }
      .actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 12px;
      }
      .note {
        margin-top: 12px;
        padding: 14px 16px;
        background: #f8f9fa;
        border: 1px solid var(--line);
        border-left: 4px solid var(--accent);
        border-radius: 12px;
        color: #374151;
        font-size: 13px;
        line-height: 1.6;
      }
      .result {
        display: none;
        margin-top: 14px;
        border-top: 1px solid var(--line);
        padding-top: 14px;
      }
      .result.show {
        display: block;
      }
      .main-num {
        text-align: center;
        padding: 24px;
        border-radius: 18px;
        border: 2px solid var(--line);
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        box-shadow: 0 2px 8px var(--shadow);
      }
      .main-num .k {
        font-size: 14px;
        color: var(--muted);
        font-weight: 700;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
      }
      .main-num .v {
        font-size: 42px;
        font-weight: 900;
        color: var(--accent);
        margin: 12px 0;
        letter-spacing: -0.5px;
      }
      .main-num .s {
        font-size: 13px;
        color: var(--muted);
        margin-top: 6px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
      }
      .cards {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
        margin-top: 12px;
      }
      @media (min-width: 720px) {
        .cards {
          grid-template-columns: 1fr 1fr;
        }
      }
      .card {
        border: 1px solid var(--line);
        border-radius: 16px;
        background: #fff;
        padding: 18px;
        box-shadow: 0 1px 3px var(--shadow);
        transition: all 0.2s ease;
      }
      .card:hover {
        box-shadow: 0 4px 12px var(--shadow-hover);
      }
      .card .ct {
        margin: 0 0 10px;
        font-weight: 850;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .kv {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 0;
        font-size: 14px;
      }
      .kv span {
        color: #374151;
      }
      .kv strong {
        font-weight: 900;
      }
      .bar {
        height: 12px;
        border-radius: 999px;
        background: #e5e7eb;
        overflow: hidden;
        margin: 10px 0 12px;
        box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
      }
      .bar > div {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--accent) 0%,
          var(--accent-hover) 100%
        );
        width: 30%;
        transition: width 0.3s ease;
        box-shadow: 0 1px 3px rgba(59, 130, 246, 0.3);
      }
      .wave {
        list-style: none;
        margin: 0;
        padding: 0;
        display: grid;
        gap: 8px;
      }
      .wave li {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        font-size: 14px;
        padding: 12px 14px;
        border-radius: 12px;
        background: #f8f9fa;
        border: 1px solid #e5e7eb;
        transition: all 0.2s ease;
      }
      .wave li:hover {
        background: #f1f3f5;
        border-color: var(--accent);
      }
      .wave li b {
        font-weight: 900;
      }
      .reserve {
        margin-top: 12px;
        padding: 14px 16px;
        border-radius: 12px;
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1) 0%,
          rgba(16, 185, 129, 0.05) 100%
        );
        border: 1.5px solid rgba(16, 185, 129, 0.3);
        color: #065f46;
        font-size: 13px;
        line-height: 1.6;
        font-weight: 600;
      }
      .mini {
        border: 1px solid var(--line);
        background: #fff;
        border-radius: 18px;
        padding: 16px;
      }
      .mini h3 {
        margin: 0 0 8px;
        font-size: 14px;
      }
      .mini ul {
        margin: 0;
        padding-left: 18px;
        color: #374151;
        font-size: 13px;
        line-height: 1.6;
      }
      .footer-fixed {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(247, 248, 250, 0.86);
        backdrop-filter: blur(10px);
        border-top: 1px solid var(--line);
        padding: 10px 12px;
      }
      .footer-fixed .inner {
        max-width: 860px;
        margin: 0 auto;
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: space-between;
      }
      .footer-fixed .inner .left {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
      }
      .tiny {
        font-size: 12px;
        color: var(--muted);
      }
      .tooltip-btn {
        width: 18px;
        height: 18px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: #fff;
        color: #555;
        font-size: 12px;
        font-weight: 900;
        cursor: pointer;
        display: inline-grid;
        place-items: center;
        padding: 0;
      }
      .tooltip-btn:hover {
        border-color: rgba(11, 18, 32, 0.35);
      }
      .tip-layer {
        position: absolute;
        z-index: 9999;
        max-width: 280px;
        background: #111;
        color: #fff;
        font-size: 13px;
        line-height: 1.45;
        padding: 10px 12px;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.22);
        display: none;
      }
      .tip-layer.show {
        display: block;
      }
      .toast {
        position: fixed;
        left: 50%;
        transform: translateX(-50%);
        bottom: 76px;
        background: #111;
        color: #fff;
        padding: 10px 12px;
        border-radius: 999px;
        font-size: 13px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.22);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.15s ease, transform 0.15s ease;
      }
      .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(-4px);
      }
      .divider {
        height: 1px;
        background: var(--line);
        margin: 10px 0;
      }
      .muted {
        color: var(--muted);
      }
      .pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: #fff;
        font-size: 12px;
        color: #374151;
        font-weight: 700;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <header>
        <div class="brand">
          <div class="brand-badge">FF</div>
          <div>
            <div style="font-weight: 900">ì„¸ê¸ˆ ê³„ì‚°ê¸°</div>
            <div class="tiny">ì§ì¥ì¸ Â· í”„ë¦¬ëœì„œ Â· ê°œì¸ì‚¬ì—…ì</div>
          </div>
        </div>
        <div class="top-actions">
          <button class="btn ghost" id="btnReset">ì´ˆê¸°í™”</button>
          <a class="btn ghost" href="./en.html">English</a>
          <a
            class="btn"
            href="https://funnyfunny.cloud"
            target="_blank"
            rel="noopener"
            >ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°</a
          >
        </div>
      </header>

      <section class="intro">
        <h1>ì„¸ê¸ˆ, ê°„ë‹¨í•˜ê²Œ ê³„ì‚°í•´ë³´ì„¸ìš”</h1>
        <p class="sub">
          ì •í™•í•œ ì‹ ê³ ìš© ê³„ì‚°ì´ ì•„ë‹ˆë¼, <b>"ì‹¤ì œ ìˆ˜ë ¹ì•¡ê³¼ ì„¸ê¸ˆ ë‚©ë¶€ ì‹œê¸°"</b>ë¥¼
          íŒŒì•…í•˜ëŠ” ì¶”ì • ë„êµ¬ì…ë‹ˆë‹¤.<br />
          í•œ ë²ˆ ì…ë ¥í•˜ë©´ <b>ì›” ì‹¤ìˆ˜ë ¹ì•¡</b>ê³¼
          <b>ì„¸ê¸ˆ ë‚©ë¶€ ì‹œê¸°(í° ê¸ˆì•¡ì´ ë‚˜ê°€ëŠ” ë‹¬)</b>ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>

        <div class="mode-row" id="modeRow">
          <button class="mode" data-mode="employee" type="button">
            <p class="t">ğŸ‘” ì§ì¥ì¸</p>
            <p class="d">ì„¸ì „ ì›”ê¸‰ â†’ ì„¸ê¸ˆ+4ëŒ€ë³´í—˜ ì¶”ì • â†’ ì²´ê° ì‹¤ìˆ˜ë ¹</p>
          </button>
          <button class="mode" data-mode="freelancer" type="button">
            <p class="t">ğŸ’» í”„ë¦¬ëœì„œ/Nì¡</p>
            <p class="d">3.3%ëŠ” â€œëâ€ì´ ì•„ë‹ˆë¼ â€œì˜ˆê³ í¸â€ì¼ ìˆ˜ ìˆì–´ìš”</p>
          </button>
          <button class="mode" data-mode="business" type="button">
            <p class="t">ğŸª ê°œì¸ì‚¬ì—…ì</p>
            <p class="d">ë¶€ê°€ì„¸Â·ì¢…ì†Œì„¸ â€œí•œ ë²ˆì— í¬ê²Œâ€ ëŒ€ë¹„í•˜ëŠ” êµ¬ì¡°</p>
          </button>
        </div>
      </section>

      <div class="grid">
        <section class="panel" id="inputPanel">
          <h2>
            ì…ë ¥
            <span class="pill" id="modePill">ëª¨ë“œ ì„ íƒ</span>
          </h2>
          <p class="hint" id="modeHint">
            ìœ„ì—ì„œ ëª¨ë“œë¥¼ ì„ íƒí•˜ë©´ í•„ìš”í•œ ì…ë ¥ë§Œ ë”± ë‚˜ì˜¤ê²Œ ë°”ë€ë‹ˆë‹¤.
          </p>

          <div class="fields" id="fieldsArea"></div>

          <div class="actions">
            <button class="btn primary" id="btnCalc">ê³„ì‚°í•˜ê¸°</button>
            <button class="btn" id="btnCopySummary">ìš”ì•½ ë³µì‚¬</button>
            <button class="btn" id="btnSave">ì…ë ¥ ì €ì¥</button>
          </div>

          <div class="note" id="disclaimer">
            <b>ì¤‘ìš”:</b> ì´ ê²°ê³¼ëŠ” ì°¸ê³ ìš© ì¶”ì •ì¹˜ì…ë‹ˆë‹¤. ê³µì œ/ì—…ì¢…/ì¦ë¹™/ê°€ì… í˜•íƒœ
            ë“±ì— ë”°ë¼ ì‹¤ì œì™€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.
            <div class="divider"></div>
            ê·¸ë˜ë„ ì´ í™”ë©´ í•˜ë‚˜ë§Œìœ¼ë¡œ
            <b>â€œì–¼ë§ˆê°€ ì™œ ë¹ ì§€ëŠ”ì§€ / ì–¸ì œ í¬ê²Œ ë‚˜ê°ˆì§€â€</b> ê°ê°ì„ ì¡ëŠ” ê²Œ
            ëª©í‘œì…ë‹ˆë‹¤.
          </div>

          <div class="result" id="resultSection">
            <div class="main-num">
              <div class="k">
                ì›” ì‹¤ìˆ˜ë ¹ì•¡ (ì¶”ì •)
                <button
                  class="tooltip-btn"
                  data-tooltip="netIncome"
                  type="button"
                >
                  â“˜
                </button>
              </div>
              <div class="v"><span id="netAmount">0</span>ì›</div>
              <div class="s">
                ì¶”ì •ì¹˜ Â· ì„¤ì •ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”
                <button
                  class="tooltip-btn"
                  data-tooltip="estimate"
                  type="button"
                >
                  â“˜
                </button>
              </div>
            </div>

            <div class="cards">
              <div class="card">
                <div class="ct">
                  ëˆì˜ íë¦„
                  <button class="tooltip-btn" data-tooltip="flow" type="button">
                    â“˜
                  </button>
                </div>
                <div class="kv">
                  <span>ë“¤ì–´ì˜¨ ëˆ</span><strong id="grossAmount">0ì›</strong>
                </div>
                <div class="bar"><div id="outBar"></div></div>
                <div class="kv">
                  <span>ë¹ ì§„ ëˆ (ì„¸ê¸ˆÂ·ë³´í—˜Â·ê²½ë¹„)</span
                  ><strong id="outAmount">0ì›</strong>
                </div>
                <div class="divider"></div>
                <div class="tiny muted" id="outBreakdown">-</div>
              </div>

              <div class="card">
                <div class="ct">
                  ì„¸ê¸ˆ íŒŒë„ ì˜ˆìƒ
                  <button
                    class="tooltip-btn"
                    data-tooltip="taxWave"
                    type="button"
                  >
                    â“˜
                  </button>
                </div>
                <ul class="wave" id="waveList"></ul>
                <div class="reserve" id="reserveBox">
                  ë§¤ë‹¬ <b id="reserveAmount">0ì›</b> ì •ë„ â€œì„¸ê¸ˆ í†µì¥â€ì— ë”°ë¡œ
                  ëª¨ì•„ë‘ë©´ ì•ˆì „í•´ìš”.
                </div>
              </div>
            </div>

            <div
              class="actions"
              style="margin-top: 12px; justify-content: center"
            >
              <button class="btn primary" id="btnRecalc">ë‹¤ì‹œ ê³„ì‚°</button>
            </div>
          </div>
        </section>

        <aside class="mini">
          <h3>ì´ˆë³´ììš© í•œ ì¤„ ì‚¬ì „</h3>
          <ul>
            <li>
              <b>3.3%</b>: ìµœì¢… ì„¸ê¸ˆì´ ì•„ë‹ˆë¼ <b>ë¯¸ë¦¬ ë–¼ëŠ” ëˆ</b>ì¼ ìˆ˜ ìˆì–´ìš”.
            </li>
            <li>
              <b>ë¶€ê°€ì„¸</b>: ë‚´ ëˆì´ ì•„ë‹ˆë¼ <b>ëŒ€ì‹  ë³´ê´€í–ˆë‹¤ê°€</b> ë‚´ëŠ”
              êµ¬ì¡°(í™˜ê¸‰ë„ ê°€ëŠ¥).
            </li>
            <li>
              <b>ì¢…í•©ì†Œë“ì„¸</b>: ë³´í†µ <b>1ë…„ì— í•œ ë²ˆ í¬ê²Œ</b> ì •ì‚°ë  ìˆ˜ ìˆì–´ìš”.
            </li>
            <li>
              <b>í•µì‹¬</b>: ì •í™•ë„ë³´ë‹¤ <b>ëˆ íë¦„ + íƒ€ì´ë°</b>ì„ ë³´ëŠ” ë„êµ¬ì˜ˆìš”.
            </li>
          </ul>
          <div class="divider"></div>
          <div class="tiny muted">
            ì €ì¥ì€ ë¸Œë¼ìš°ì €(ë¡œì»¬)ì—ë§Œ ë©ë‹ˆë‹¤. ì„œë²„ë¡œ ì „ì†¡í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
          </div>
        </aside>
      </div>
    </div>

    <div class="footer-fixed">
      <div class="inner">
        <div class="left">
          <a
            class="btn"
            href="https://funnyfunny.cloud"
            target="_blank"
            rel="noopener"
            >ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°</a
          >
          <a class="btn ghost" href="./en.html">English</a>
          <span class="tiny">Â© funnyfunny.cloud</span>
        </div>
        <div class="tiny">Â· ë³¸ ê²°ê³¼ëŠ” ëŒ€ëµì ì¸ ì¶”ì •ì¹˜ì…ë‹ˆë‹¤</div>
      </div>
    </div>

    <div
      id="tooltipLayer"
      class="tip-layer"
      role="tooltip"
      aria-hidden="true"
    ></div>
    <div id="toast" class="toast">ë³µì‚¬í–ˆì–´ìš”</div>

    <script>
      // -----------------------------
      // Tooltips (ê²°ê³¼ ë‚©ë“/ì•ˆì‹¬ìš©)
      // -----------------------------
      const TOOLTIPS = {
        netIncome:
          "ì„¸ê¸ˆ, ë³´í—˜, ê²½ë¹„ë¥¼ ì œì™¸í•œ ì‹¤ì œë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ê¸ˆì•¡ì…ë‹ˆë‹¤. ê³µì œ ë° ì—…ì¢…ì— ë”°ë¼ ì‹¤ì œ ê²°ê³¼ì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        estimate:
          "ê³µì œ í•­ëª©, ì—…ì¢…, ì¦ë¹™ ë°©ì‹, ê°€ì… í˜•íƒœ ë“±ì— ë”°ë¼ ì‹¤ì œ ë‚©ë¶€ì•¡ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì •í™•í•œ ê³„ì‚°ì€ ì„¸ë¬´ ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.",
        flow: "ì´ ìˆ˜ì…ì—ì„œ ì„¸ê¸ˆ, ë³´í—˜, ê²½ë¹„ê°€ ì–´ë–»ê²Œ ì°¨ê°ë˜ëŠ”ì§€ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        taxWave:
          "ì‚¬ì—…ìì™€ í”„ë¦¬ëœì„œëŠ” íŠ¹ì • ì‹œê¸°ì— ì„¸ê¸ˆì´ í•œêº¼ë²ˆì— ë‚©ë¶€ë˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ë¯¸ë¦¬ ì¤€ë¹„í•˜ë©´ ë¶€ë‹´ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
      };

      // -----------------------------
      // State
      // -----------------------------
      const state = {
        mode: null, // employee | freelancer | business
        input: {},
        result: {},
      };

      // -----------------------------
      // Helpers
      // -----------------------------
      const $ = (id) => document.getElementById(id);

      function fmt(n) {
        if (!isFinite(n)) return "0";
        return Math.round(n).toLocaleString("ko-KR");
      }
      function toNumber(val) {
        if (val === null || val === undefined) return 0;
        const s = String(val).replace(/[,\s]/g, "");
        const n = Number(s);
        return isFinite(n) ? n : 0;
      }
      function clamp(n, a, b) {
        return Math.max(a, Math.min(b, n));
      }

      function toast(msg = "ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤") {
        const t = $("toast");
        t.textContent = msg;
        t.classList.add("show");
        setTimeout(() => t.classList.remove("show"), 1500);
      }

      async function copyText(text) {
        try {
          await navigator.clipboard.writeText(text);
          toast("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤");
        } catch {
          // fallback
          const ta = document.createElement("textarea");
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand("copy");
          document.body.removeChild(ta);
          toast("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤");
        }
      }

      // -----------------------------
      // Mode UI
      // -----------------------------
      const modeButtons = Array.from(document.querySelectorAll(".mode"));
      modeButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const mode = btn.dataset.mode;
          setMode(mode);
        });
      });

      function setMode(mode) {
        state.mode = mode;
        modeButtons.forEach((b) =>
          b.classList.toggle("active", b.dataset.mode === mode)
        );

        const pill = $("modePill");
        const hint = $("modeHint");
        if (mode === "employee") {
          pill.textContent = "ğŸ‘” ì§ì¥ì¸";
          hint.textContent =
            "ì„¸ì „ ì›”ê¸‰ ê¸°ì¤€ìœ¼ë¡œ ì„¸ê¸ˆ+4ëŒ€ë³´í—˜ì„ ë‹¨ìˆœ ì¶”ì •í•´ì„œ â€œì²´ê° ì‹¤ìˆ˜ë ¹â€ì„ ë³´ì—¬ì¤˜ìš”.";
        } else if (mode === "freelancer") {
          pill.textContent = "ğŸ’» í”„ë¦¬ëœì„œ/Nì¡";
          hint.textContent =
            "ìˆ˜ì…/ê²½ë¹„ ë¹„ìœ¨ì„ ê¸°ë°˜ìœ¼ë¡œ 3.3% ì›ì²œì§•ìˆ˜ëŠ” â€˜ë¯¸ë¦¬ ë‚¸ ëˆâ€™ìœ¼ë¡œ ë³´ê³  ì •ì‚° ê°ê°ì„ ë³´ì—¬ì¤˜ìš”.";
        } else if (mode === "business") {
          pill.textContent = "ğŸª ê°œì¸ì‚¬ì—…ì";
          hint.textContent =
            "ì›” ë§¤ì¶œ/ê²½ë¹„ë¡œ ìˆœì´ìµì„ ì¶”ì •í•˜ê³ , ë¶€ê°€ì„¸/ì¢…ì†Œì„¸ â€˜íŒŒë„â€™ë¥¼ ëŒ€ë¹„í•˜ëŠ” ê·¸ë¦¼ì„ ë³´ì—¬ì¤˜ìš”.";
        } else {
          pill.textContent = "ëª¨ë“œ ì„ íƒ";
          hint.textContent =
            "ìœ„ì—ì„œ ëª¨ë“œë¥¼ ì„ íƒí•˜ë©´ í•„ìš”í•œ ì…ë ¥ë§Œ ë”± ë‚˜ì˜¤ê²Œ ë°”ë€ë‹ˆë‹¤.";
        }

        renderFields();
        $("resultSection").classList.remove("show");
      }

      // -----------------------------
      // Field Renderer
      // -----------------------------
      function fieldText({
        key,
        label,
        placeholder,
        tooltip,
        defaultValue = "",
      }) {
        return `
        <div class="field">
          <div class="label">${label}
            ${
              tooltip
                ? `<button class="tooltip-btn" data-tooltip="${tooltip}" type="button">â“˜</button>`
                : ""
            }
          </div>
          <input type="text" inputmode="numeric" id="${key}" placeholder="${placeholder}" value="${defaultValue}" />
        </div>
      `;
      }

      function fieldSelect({ key, label, tooltip, options, defaultValue }) {
        const opts = options
          .map(
            (o) =>
              `<option value="${o.value}" ${
                String(o.value) === String(defaultValue) ? "selected" : ""
              }>${o.label}</option>`
          )
          .join("");
        return `
        <div class="field">
          <div class="label">${label}
            ${
              tooltip
                ? `<button class="tooltip-btn" data-tooltip="${tooltip}" type="button">â“˜</button>`
                : ""
            }
          </div>
          <select id="${key}">${opts}</select>
        </div>
      `;
      }

      function fieldSegment({ key, label, tooltip, items, defaultValue }) {
        const btns = items
          .map(
            (it) => `
        <button type="button" data-k="${key}" data-v="${it.value}" class="${
              String(it.value) === String(defaultValue) ? "active" : ""
            }">
          ${it.label}
        </button>
      `
          )
          .join("");
        return `
        <div class="field">
          <div class="label">${label}
            ${
              tooltip
                ? `<button class="tooltip-btn" data-tooltip="${tooltip}" type="button">â“˜</button>`
                : ""
            }
          </div>
          <div class="seg" id="${key}__seg">${btns}</div>
        </div>
      `;
      }

      function renderFields() {
        const area = $("fieldsArea");

        // load saved defaults (if any)
        const saved = loadSavedInput();

        let html = "";
        if (!state.mode) {
          area.innerHTML = `<div class="note">ë¨¼ì € ìƒë‹¨ì—ì„œ <b>ëª¨ë“œ</b>ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>`;
          return;
        }

        if (state.mode === "employee") {
          html += fieldText({
            key: "salary",
            label: "ì„¸ì „ ì›”ê¸‰(ì›)",
            placeholder: "ì˜ˆ: 3,500,000",
            tooltip: "estimate",
            defaultValue: saved.salary ?? "",
          });
          html +=
            `<div class="row2">` +
            fieldSelect({
              key: "dependents",
              label: "ë¶€ì–‘ê°€ì¡± ìˆ˜(ì„ íƒ)",
              options: [
                { value: 0, label: "0" },
                { value: 1, label: "1" },
                { value: 2, label: "2" },
                { value: 3, label: "3+" },
              ],
              defaultValue: saved.dependents ?? 0,
            }) +
            fieldSelect({
              key: "deductionLevel",
              label: "ì—°ë§ì •ì‚° ê³µì œ(ì„ íƒ)",
              tooltip: "estimate",
              options: [
                { value: "low", label: "ê±°ì˜ ì—†ìŒ" },
                { value: "mid", label: "í‰ê· " },
                { value: "high", label: "ë§ì´ ë°›ëŠ” í¸" },
              ],
              defaultValue: saved.deductionLevel ?? "mid",
            }) +
            `</div>`;

          html += `<div class="note">
          <b>ì§ì¥ì¸ í¬ì¸íŠ¸</b><br/>
          ë§¤ë‹¬ ì›”ê¸‰ì—ì„œ ìë™ìœ¼ë¡œ ë¹ ì§€ëŠ” ê±´ ì£¼ë¡œ <b>ì†Œë“ì„¸(ì§€ë°©ì„¸ í¬í•¨) + 4ëŒ€ë³´í—˜</b>ì´ì—ìš”.<br/>
          ì—°ë§ì •ì‚°ì€ â€œë‚˜ì¤‘ì— ì •ì‚°â€ì´ë¼ í™˜ê¸‰/ì¶”ê°€ë‚©ë¶€ê°€ ìƒê¸¸ ìˆ˜ ìˆì–´ìš”.
        </div>`;
        }

        if (state.mode === "freelancer") {
          html += fieldText({
            key: "income",
            label: "ì›” í‰ê·  ìˆ˜ì…(ì›)",
            placeholder: "ì˜ˆ: 4,000,000",
            tooltip: "estimate",
            defaultValue: saved.income ?? "",
          });
          html +=
            `<div class="row2">` +
            fieldSelect({
              key: "expenseRate",
              label: "ê²½ë¹„ ë¹„ìœ¨(%)",
              tooltip: "flow",
              options: [
                { value: 10, label: "10%" },
                { value: 20, label: "20%" },
                { value: 30, label: "30%" },
                { value: 40, label: "40%" },
                { value: 50, label: "50%" },
                { value: 60, label: "60%" },
                { value: 70, label: "70%" },
              ],
              defaultValue: saved.expenseRate ?? 30,
            }) +
            fieldSegment({
              key: "withholding",
              label: "3.3% ë–¼ê³  ë°›ë‚˜ìš”?",
              tooltip: "taxWave",
              items: [
                { value: "yes", label: "ì˜ˆ" },
                { value: "no", label: "ì•„ë‹ˆì˜¤" },
                { value: "unknown", label: "ëª¨ë¥´ê² ìŒ" },
              ],
              defaultValue: saved.withholding ?? "yes",
            }) +
            `</div>`;

          html += `<div class="note">
          <b>í”„ë¦¬ëœì„œ í¬ì¸íŠ¸</b><br/>
          <b>3.3%</b>ëŠ” ìµœì¢… ì„¸ê¸ˆì´ ì•„ë‹ˆë¼ <b>ë¯¸ë¦¬ ë–¼ëŠ” ëˆ(ì›ì²œì§•ìˆ˜)</b>ì¼ ìˆ˜ ìˆì–´ìš”.<br/>
          ì‹¤ì œ ì„¸ê¸ˆì€ ë³´í†µ ë‹¤ìŒ í•´ì— ì •ì‚°ë  ìˆ˜ ìˆê³ , ê²½ë¹„/ê³µì œì— ë”°ë¼ í™˜ê¸‰ë„ ê°€ëŠ¥í•´ìš”.
        </div>`;
        }

        if (state.mode === "business") {
          html += fieldText({
            key: "sales",
            label: "ì›” ë§¤ì¶œ(ì›)",
            placeholder: "ì˜ˆ: 10,000,000",
            tooltip: "flow",
            defaultValue: saved.sales ?? "",
          });
          html += fieldText({
            key: "cost",
            label: "ì›” ê²½ë¹„(ì›)",
            placeholder: "ì˜ˆ: 6,000,000",
            tooltip: "flow",
            defaultValue: saved.cost ?? "",
          });

          html +=
            `<div class="row2">` +
            fieldSegment({
              key: "vatType",
              label: "ì—…ì¢…(ë¶€ê°€ì„¸)",
              tooltip: "taxWave",
              items: [
                { value: "taxable", label: "ê³¼ì„¸" },
                { value: "exempt", label: "ë©´ì„¸" },
                { value: "unknown", label: "ëª¨ë¥´ê² ìŒ" },
              ],
              defaultValue: saved.vatType ?? "taxable",
            }) +
            fieldSegment({
              key: "vatScheme",
              label: "ë¶€ê°€ì„¸ ë°©ì‹",
              tooltip: "taxWave",
              items: [
                { value: "general", label: "ì¼ë°˜" },
                { value: "simple", label: "ê°„ì´" },
                { value: "unknown", label: "ëª¨ë¥´ê² ìŒ" },
              ],
              defaultValue: saved.vatScheme ?? "general",
            }) +
            `</div>`;

          html += `<div class="note">
          <b>ì‚¬ì—…ì í¬ì¸íŠ¸</b><br/>
          ë¶€ê°€ì„¸ëŠ” ê³ ê°ì—ê²Œ ë°›ì€ ì„¸ê¸ˆì„ <b>ì ê¹ ë³´ê´€í–ˆë‹¤ê°€</b> ë‚´ëŠ” êµ¬ì¡°ì˜ˆìš”(í™˜ê¸‰ë„ ê°€ëŠ¥).<br/>
          ì¢…í•©ì†Œë“ì„¸ëŠ” ë³´í†µ <b>1ë…„ì— í•œ ë²ˆ í¬ê²Œ</b> ë‚˜ê°ˆ ìˆ˜ ìˆì–´ì„œ â€œì„¸ê¸ˆ í†µì¥â€ì´ ìœ ìš©í•´ìš”.
        </div>`;
        }

        area.innerHTML = html;

        // segment buttons wiring
        area.querySelectorAll(".seg button").forEach((b) => {
          b.addEventListener("click", () => {
            const key = b.dataset.k;
            const seg = $("" + key + "__seg");
            seg
              .querySelectorAll("button")
              .forEach((x) => x.classList.toggle("active", x === b));
          });
        });

        // numeric formatting on input
        area.querySelectorAll('input[type="text"]').forEach((inp) => {
          inp.addEventListener("input", () => {
            const raw = inp.value.replace(/[^\d]/g, "");
            // allow empty
            if (raw.length === 0) {
              inp.value = "";
              return;
            }
            inp.value = Number(raw).toLocaleString("ko-KR");
          });
        });
      }

      // -----------------------------
      // Input Read
      // -----------------------------
      function readSegment(key) {
        const seg = document.getElementById(key + "__seg");
        if (!seg) return null;
        const active = seg.querySelector("button.active");
        return active ? active.dataset.v : null;
      }

      function readInput() {
        const mode = state.mode;
        const input = {};
        if (mode === "employee") {
          input.salary = toNumber($("salary")?.value);
          input.dependents = Number($("dependents")?.value ?? 0);
          input.deductionLevel = $("deductionLevel")?.value ?? "mid";
        }
        if (mode === "freelancer") {
          input.income = toNumber($("income")?.value);
          input.expenseRate = Number($("expenseRate")?.value ?? 30);
          input.withholding = readSegment("withholding") ?? "unknown";
        }
        if (mode === "business") {
          input.sales = toNumber($("sales")?.value);
          input.cost = toNumber($("cost")?.value);
          input.vatType = readSegment("vatType") ?? "unknown";
          input.vatScheme = readSegment("vatScheme") ?? "unknown";
        }
        state.input = input;
        return input;
      }

      // -----------------------------
      // Approx Tax Model (ê°„ë‹¨ ì¶”ì •)
      // - ë²•/ì„¸ìœ¨ ì •í™• ê³„ì‚°ì´ ëª©ì ì´ ì•„ë‹˜
      // - "ê°ê°"ê³¼ "ëˆ íë¦„"ì´ ëª©í‘œ
      // -----------------------------
      function employeeModel({ salary, dependents, deductionLevel }) {
        const gross = salary;
        if (gross <= 0) return null;

        // Rough income tax rate by monthly salary brackets (very rough)
        // lower bracket -> smaller rate
        let taxRate;
        const monthly = gross;
        if (monthly < 2500000) taxRate = 0.05;
        else if (monthly < 4000000) taxRate = 0.08;
        else if (monthly < 6000000) taxRate = 0.11;
        else if (monthly < 9000000) taxRate = 0.14;
        else taxRate = 0.17;

        // dependents reduce a bit
        taxRate -= clamp(dependents, 0, 3) * 0.006; // up to -1.8%
        // deduction level tweak
        if (deductionLevel === "low") taxRate += 0.01;
        if (deductionLevel === "high") taxRate -= 0.01;

        taxRate = clamp(taxRate, 0.03, 0.19);

        // 4 insurances (employee share) rough 9% of gross
        // (real differs; used for feel)
        const insuranceRate = 0.09;

        const incomeTax = gross * taxRate;
        const insurance = gross * insuranceRate;

        const out = incomeTax + insurance;
        const net = Math.max(0, gross - out);

        // wave schedule (employee: no big wave, but annual settlement)
        const waves = [
          { month: "2~3ì›”", label: "ì—°ë§ì •ì‚° ì •ì‚°(í™˜ê¸‰/ì¶”ê°€)", strong: true },
          { month: "ë§¤ë‹¬", label: "ì†Œë“ì„¸Â·4ëŒ€ë³´í—˜ ìë™ ê³µì œ", strong: false },
        ];

        // reserve suggestion: small buffer for potential additional payment
        const reserve = Math.round(gross * 0.02);

        return {
          gross,
          out,
          net,
          breakdown: {
            "ì†Œë“ì„¸(ì§€ë°©ì„¸ í¬í•¨, ì¶”ì •)": incomeTax,
            "4ëŒ€ë³´í—˜(ì¶”ì •)": insurance,
          },
          waves,
          reserve,
        };
      }

      function freelancerModel({ income, expenseRate, withholding }) {
        const gross = income;
        if (gross <= 0) return null;

        const expRate = clamp(expenseRate / 100, 0, 0.8);
        const expense = gross * expRate;
        const taxableBase = Math.max(0, gross - expense);

        // rough effective tax rate by taxable base (monthly)
        let effRate;
        if (taxableBase < 2000000) effRate = 0.05;
        else if (taxableBase < 3500000) effRate = 0.08;
        else if (taxableBase < 5500000) effRate = 0.11;
        else if (taxableBase < 8000000) effRate = 0.14;
        else effRate = 0.17;

        // predicted annualization impact (rough): push up slightly
        effRate += 0.01;
        effRate = clamp(effRate, 0.05, 0.22);

        const predictedTax = taxableBase * effRate;

        // already withheld
        let prepaid = 0;
        if (withholding === "yes") prepaid = gross * 0.033;
        else if (withholding === "unknown") prepaid = gross * 0.02;

        // monthly net cashflow approximation:
        // user receives gross - prepaid (if any). but we'll show "out" includes expense + predictedTax
        // since expense is "gone money", and predictedTax is "should reserve".
        const out = expense + predictedTax;
        const net = Math.max(0, gross - out);

        const waves = [
          {
            month: "5ì›”",
            label: "ì¢…í•©ì†Œë“ì„¸ ì •ì‚°(ì¶”ê°€ë‚©ë¶€/í™˜ê¸‰)",
            strong: true,
          },
          {
            month: "ë§¤ë‹¬",
            label: "ê²½ë¹„ + (ì›ì²œì§•ìˆ˜/ì„¸ê¸ˆ ì ë¦½) ê´€ë¦¬",
            strong: false,
          },
        ];

        // reserve suggestion: predictedTax - prepaid (if positive), plus a buffer
        const reserve = Math.round(
          Math.max(0, predictedTax - prepaid) + gross * 0.01
        );

        return {
          gross,
          out,
          net,
          breakdown: {
            "ê²½ë¹„(ì¶”ì •)": expense,
            "ì„¸ê¸ˆ ì ë¦½(ì¶”ì •)": predictedTax,
          },
          waves,
          reserve,
          extra: { prepaid },
        };
      }

      function businessModel({ sales, cost, vatType, vatScheme }) {
        const gross = sales;
        if (gross <= 0) return null;

        const expense = Math.max(0, cost);
        const profit = Math.max(0, gross - expense);

        // rough income tax reserve rate for business profit
        let taxReserveRate;
        if (profit < 2000000) taxReserveRate = 0.06;
        else if (profit < 4000000) taxReserveRate = 0.1;
        else if (profit < 7000000) taxReserveRate = 0.14;
        else taxReserveRate = 0.18;
        taxReserveRate = clamp(taxReserveRate, 0.06, 0.25);

        const incomeTaxReserve = profit * taxReserveRate;

        // VAT reserve (only if taxable; simplified)
        // General: net VAT approx (sales - cost) * 10% * 0.4 (assume some deductibility)
        // Simple: smaller/more variable -> use lower reserve factor
        let vatReserve = 0;
        const isTaxable = vatType === "taxable" || vatType === "unknown";
        if (isTaxable) {
          const baseVat = Math.max(0, gross * 0.1);
          if (vatScheme === "general") vatReserve = baseVat * 0.35;
          else if (vatScheme === "simple") vatReserve = baseVat * 0.18;
          else vatReserve = baseVat * 0.25;
        }

        const out = expense + incomeTaxReserve + vatReserve;
        const net = Math.max(0, gross - out);

        const waves = [];
        // VAT wave
        if (isTaxable) {
          waves.push({
            month: "1ì›”/7ì›”",
            label: "ë¶€ê°€ì„¸ ì‹ ê³ Â·ë‚©ë¶€(ëŒ€ëµ)",
            strong: true,
          });
        } else {
          waves.push({
            month: "-",
            label: "ë©´ì„¸ ì—…ì¢…ì€ ë¶€ê°€ì„¸ ë¶€ë‹´ì´ ë‹¤ë¥¼ ìˆ˜ ìˆì–´ìš”",
            strong: false,
          });
        }
        // Income tax wave
        waves.push({
          month: "5ì›”",
          label: "ì¢…í•©ì†Œë“ì„¸(í° íŒŒë„)",
          strong: true,
        });
        waves.push({ month: "11ì›”", label: "ì¤‘ê°„ì˜ˆë‚© ê°€ëŠ¥ì„±", strong: false });

        const reserve = Math.round(incomeTaxReserve + vatReserve);

        const breakdown = {
          "ê²½ë¹„(ì¶”ì •)": expense,
          "ì„¸ê¸ˆ ì ë¦½(ì¢…ì†Œì„¸, ì¶”ì •)": incomeTaxReserve,
        };
        if (isTaxable) {
          breakdown["ë¶€ê°€ì„¸ ì ë¦½(ì¶”ì •)"] = vatReserve;
        }

        return { gross, out, net, breakdown, waves, reserve };
      }

      function calculate() {
        const input = readInput();

        let res = null;
        if (state.mode === "employee") res = employeeModel(input);
        if (state.mode === "freelancer") res = freelancerModel(input);
        if (state.mode === "business") res = businessModel(input);

        return res;
      }

      // -----------------------------
      // Render Result
      // -----------------------------
      function renderResult(res) {
        state.result = res;

        $("netAmount").textContent = fmt(res.net);
        $("grossAmount").textContent = fmt(res.gross) + "ì›";
        $("outAmount").textContent = fmt(res.out) + "ì›";

        const outPct = res.gross > 0 ? res.out / res.gross : 0;
        $("outBar").style.width =
          (clamp(outPct, 0, 0.95) * 100).toFixed(1) + "%";

        const lines = Object.entries(res.breakdown).map(([k, v]) => {
          return `â€¢ ${k}: ${fmt(v)}ì›`;
        });

        // extra info (freelancer: prepaid)
        if (state.mode === "freelancer" && res.extra?.prepaid) {
          lines.push(
            `â€¢ (ì°¸ê³ ) ì´ë¯¸ ë–¼ê³  ë°›ì€ 3.3% ì¶”ì •: ${fmt(res.extra.prepaid)}ì›`
          );
        }

        $("outBreakdown").textContent = lines.join("  |  ");

        // waves
        const ul = $("waveList");
        ul.innerHTML = "";
        res.waves.forEach((w) => {
          const li = document.createElement("li");
          li.innerHTML = `<span><b>${w.month}</b></span><span>${w.label}</span>`;
          ul.appendChild(li);
        });

        $("reserveAmount").textContent = fmt(res.reserve) + "ì›";

        $("resultSection").classList.add("show");
        $("resultSection").scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }

      // -----------------------------
      // Save/Load (local only)
      // -----------------------------
      const STORAGE_KEY = "ff_tax_click_v1";

      function saveInput() {
        if (!state.mode) return;
        const input = readInput();
        const payload = { mode: state.mode, input };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
        toast("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤");
      }

      function loadSavedInput() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return {};
          const obj = JSON.parse(raw);
          // only return input for current mode; if mode not set, return whatever
          if (!obj?.input) return {};
          return obj.input;
        } catch {
          return {};
        }
      }

      function bootFromStorage() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return;
          const obj = JSON.parse(raw);
          if (!obj?.mode) return;
          setMode(obj.mode);

          // fields are rendered; now apply values
          const input = obj.input || {};
          setTimeout(() => {
            if (obj.mode === "employee") {
              if ($("salary"))
                $("salary").value = input.salary
                  ? Number(input.salary).toLocaleString("ko-KR")
                  : "";
              if ($("dependents"))
                $("dependents").value = String(input.dependents ?? 0);
              if ($("deductionLevel"))
                $("deductionLevel").value = input.deductionLevel ?? "mid";
            }
            if (obj.mode === "freelancer") {
              if ($("income"))
                $("income").value = input.income
                  ? Number(input.income).toLocaleString("ko-KR")
                  : "";
              if ($("expenseRate"))
                $("expenseRate").value = String(input.expenseRate ?? 30);
              // segment
              const v = input.withholding ?? "yes";
              const seg = $("withholding__seg");
              if (seg) {
                seg
                  .querySelectorAll("button")
                  .forEach((b) =>
                    b.classList.toggle("active", b.dataset.v === v)
                  );
              }
            }
            if (obj.mode === "business") {
              if ($("sales"))
                $("sales").value = input.sales
                  ? Number(input.sales).toLocaleString("ko-KR")
                  : "";
              if ($("cost"))
                $("cost").value = input.cost
                  ? Number(input.cost).toLocaleString("ko-KR")
                  : "";
              const vatType = input.vatType ?? "taxable";
              const vatScheme = input.vatScheme ?? "general";
              const segA = $("vatType__seg");
              const segB = $("vatScheme__seg");
              if (segA)
                segA
                  .querySelectorAll("button")
                  .forEach((b) =>
                    b.classList.toggle("active", b.dataset.v === vatType)
                  );
              if (segB)
                segB
                  .querySelectorAll("button")
                  .forEach((b) =>
                    b.classList.toggle("active", b.dataset.v === vatScheme)
                  );
            }
          }, 0);
        } catch {}
      }

      // -----------------------------
      // Buttons
      // -----------------------------
      $("btnCalc").addEventListener("click", () => {
        if (!state.mode) {
          toast("ëª¨ë“œë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”");
          return;
        }
        const res = calculate();
        if (!res) {
          toast("í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
          return;
        }
        renderResult(res);
      });

      $("btnRecalc").addEventListener("click", () => {
        $("resultSection").classList.remove("show");
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      $("btnSave").addEventListener("click", () => {
        if (!state.mode) {
          toast("ëª¨ë“œë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”");
          return;
        }
        saveInput();
      });

      $("btnCopySummary").addEventListener("click", () => {
        if (!state.mode) {
          copyText("ì„¸ê¸ˆ ê³„ì‚°ê¸° - ëª¨ë“œë¥¼ ì„ íƒí•˜ê³  ì…ë ¥í•´ ë³´ì„¸ìš”.");
          return;
        }
        const input = readInput();
        const res =
          state.result && isFinite(state.result.net) ? state.result : null;

        const modeName =
          state.mode === "employee"
            ? "ì§ì¥ì¸"
            : state.mode === "freelancer"
            ? "í”„ë¦¬ëœì„œ/Nì¡"
            : "ê°œì¸ì‚¬ì—…ì";

        let text = `ì„¸ê¸ˆ ê³„ì‚°ê¸° (${modeName})\n`;

        if (state.mode === "employee") {
          text += `- ì„¸ì „ ì›”ê¸‰: ${fmt(input.salary)}ì›\n- ë¶€ì–‘ê°€ì¡±: ${
            input.dependents
          }\n- ê³µì œ: ${input.deductionLevel}\n`;
        }
        if (state.mode === "freelancer") {
          text += `- ì›” ìˆ˜ì…: ${fmt(input.income)}ì›\n- ê²½ë¹„ ë¹„ìœ¨: ${
            input.expenseRate
          }%\n- 3.3%: ${input.withholding}\n`;
        }
        if (state.mode === "business") {
          text += `- ì›” ë§¤ì¶œ: ${fmt(input.sales)}ì›\n- ì›” ê²½ë¹„: ${fmt(
            input.cost
          )}ì›\n- ì—…ì¢…(ë¶€ê°€ì„¸): ${input.vatType}\n- ë¶€ê°€ì„¸ ë°©ì‹: ${
            input.vatScheme
          }\n`;
        }

        if (res) {
          text += `\n[ê²°ê³¼(ì¶”ì •)]\n- ë“¤ì–´ì˜¨ ëˆ: ${fmt(
            res.gross
          )}ì›\n- ë¹ ì§„ ëˆ: ${fmt(res.out)}ì›\n- ì‹¤ìˆ˜ë ¹ì•¡: ${fmt(
            res.net
          )}ì›\n- ì„¸ê¸ˆ í†µì¥ ì¶”ì²œ: ${fmt(res.reserve)}ì›/ì›”\n`;
        } else {
          text += `\n(ê²°ê³¼ëŠ” 'ê³„ì‚°í•˜ê¸°' í›„ í™•ì¸)\n`;
        }

        text += `\nhttps://funnyfunny.cloud`;
        copyText(text);
      });

      $("btnReset").addEventListener("click", () => {
        state.mode = null;
        state.input = {};
        state.result = {};
        modeButtons.forEach((b) => b.classList.remove("active"));
        $("modePill").textContent = "ëª¨ë“œ ì„ íƒ";
        $("modeHint").textContent =
          "ìœ„ì—ì„œ ëª¨ë“œë¥¼ ì„ íƒí•˜ë©´ í•„ìš”í•œ ì…ë ¥ë§Œ ë”± ë‚˜ì˜¤ê²Œ ë°”ë€ë‹ˆë‹¤.";
        $(
          "fieldsArea"
        ).innerHTML = `<div class="note">ë¨¼ì € ìƒë‹¨ì—ì„œ <b>ëª¨ë“œ</b>ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>`;
        $("resultSection").classList.remove("show");
        toast("ì´ˆê¸°í™”!");
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      // -----------------------------
      // Tooltip layer (single instance)
      // -----------------------------
      const tipLayer = $("tooltipLayer");

      document.addEventListener("click", (e) => {
        const btn = e.target.closest(".tooltip-btn");
        if (btn) {
          const key = btn.dataset.tooltip;
          const text = TOOLTIPS[key] || "ì„¤ëª… ì¤€ë¹„ì¤‘";
          tipLayer.textContent = text;

          const rect = btn.getBoundingClientRect();
          const left = rect.left + window.scrollX;
          const top = rect.bottom + window.scrollY + 8;

          tipLayer.style.left = left + "px";
          tipLayer.style.top = top + "px";
          tipLayer.classList.add("show");
          tipLayer.setAttribute("aria-hidden", "false");
          return;
        }
        tipLayer.classList.remove("show");
        tipLayer.setAttribute("aria-hidden", "true");
      });

      window.addEventListener("scroll", () => {
        tipLayer.classList.remove("show");
        tipLayer.setAttribute("aria-hidden", "true");
      });

      // -----------------------------
      // Boot
      // -----------------------------
      renderFields();
      bootFromStorage();
    </script>
  
<ins class="adsbygoogle"
     style="display:block; text-align:center"
     data-ad-client="ca-pub-1204894220949193"
     data-ad-slot="5145068706"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

  </body>
</html>
